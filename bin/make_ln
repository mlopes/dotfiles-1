#!/bin/bash

DOTDIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )/.." && pwd )"
pushd "$DOTDIR"
git submodule sync --recursive
git submodule update --recursive
popd

mkdir -p ~/.config

ln -nfs $DOTDIR/shell ~/.shell

ln -nfs $DOTDIR/vim        ~/.vim
ln -nfs $DOTDIR/vim/vimrc  ~/.vimrc
ln -nfs $DOTDIR/vim/gvimrc ~/.gvimrc

ln -nfs $DOTDIR/emacs      ~/.emacs.d
ln -nfs $DOTDIR/rc/spacemacs      ~/.spacemacs

ln -nfs $DOTDIR/hammerspoon      ~/.hammerspoon

# ln -nfs $DOTDIR/rc/zshrc            ~/.zshrc
ln -nfs $DOTDIR/rc/tmux.conf        ~/.tmux.conf
ln -nfs $DOTDIR/rc/npmrc            ~/.npmrc
ln -nfs $DOTDIR/rc/jslintrc         ~/.jslintrc
ln -nfs $DOTDIR/rc/ghci             ~/.ghci
ln -nfs $DOTDIR/rc/gitconfig        ~/.gitconfig
ln -nfs $DOTDIR/rc/gitignore_global ~/.gitignore_global
# ln -nfs $DOTDIR/rc/teamocil         ~/.teamocil

# ln -Tnfs $DOTDIR/urxvt               ~/.urxvt
# ln -Tnfs $DOTDIR/xmonad              ~/.xmonad
# ln -Tnfs $DOTDIR/xmonad/taffybar     ~/.config/taffybar
ln -nfs $DOTDIR/rc/bashrc            ~/.bashrc
# ln -nfs $DOTDIR/rc/Xdefaults         ~/.Xdefaults
# ln -nfs $DOTDIR/rc/xsession          ~/.xsession
# ln -nfs $DOTDIR/rc/xsessionrc        ~/.xsessionrc

mkdir -p ~/.config/fish
ln -fs $DOTDIR/rc/config.fish ~/.config/fish/

# pushd ~/.xmonad/
# export PATH="$HOME/.xmonad/.cabal-sandbox/bin:~/.cabal/bin/cabal:$PATH"
# cabal sandbox init
# cabal update
# cabal install xmonad xmonad-contrib xmonad-extras xmonad-utils
# bash ./build_threaded
# popd

if which xrdb >>/dev/null ; then
    test -f ~/.Xdefaults && xrdb merge ~/.Xdefaults
fi

# if [ -d /etc/resolver ]; then
#     sudo ln -nfs $DOTDIR/rc/resolver/dev /etc/resolver/dev
# fi

# if [ -d /usr/local/php5 ]; then
#    ln -nfs $DOTDIR/rc/php/*.ini /usr/local/php5/php.d/
# fi

#if [ -d /etc/apache2/users ]; then
#    sudo ln -nfs $DOTDIR/rc/apache/autohosts.conf /etc/apache2/users/autohosts.conf
# fi

# mkdir -p ~/.fonts/
# ln -fs $DOTDIR/powerline/font/PowerlineSymbols.otf ~/.fonts/

# mkdir -p ~/.config/fontconfig/conf.d/
# ln -fs $DOTDIR/powerline/font/10-powerline-symbols.conf ~/.config/fontconfig/conf.d/

# fc-cache -vf ~/.fonts

# for mate 1.6:
# gsettings set org.mate.session.required-components windowmanager xmonad

